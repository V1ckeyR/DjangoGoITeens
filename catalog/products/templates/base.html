{% load custom_filters %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %} {% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
</head>
<body class="d-flex flex-column vh-100">
    <header>
        <nav class="navbar navbar-dark bg-dark navbar-expand-lg">
            <div class="container container d-flex flex-column">
                <div class="w-100">
                    <ul class="navbar-nav">
                        <li class="nav-item"><a class="navbar-brand" href="{% url 'home' %}">Main</a></li>
                        <li class="nav-item"><a class="nav-link" href="{% url 'index' %}">Products</a></li>
                    </ul>
                </div>
                <div class="w-100">
                    <ul class="navbar-nav ms-auto">
                        <!-- –§–æ—Ä–º–∞ —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è -->
                        <li class="nav-item text-light">
                            <form method="GET" action="{% url 'index' %}" class="d-flex mx-auto">
                                <input class="form-control me-2" type="search" name="search" value="{{ request.GET.search|default:'' }}" placeholder="üîç –ü–æ—à—É–∫ —Ç–æ–≤–∞—Ä—ñ–≤..." onchange="this.form.submit()">
    
                                <select name="category", class="form-select me-2" onchange="this.form.submit()">
                                    <option value="" {% if not request.GET.category %}selected{% endif %}>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</option>
                                    {% for category in categories %}
                                    <option value="{{ category.id }}" {% if request.GET.category == category.id|stringformat:"s"  %}selected{% endif %}>{{ category.name }}</option>
                                    {% endfor %}
                                </select>
    
                                <select name="sort_by" class="form-select me-2" onchange="this.form.submit()">
                                    <option value="" {% if not request.GET.sort_by %}selected{% endif %}>–°–æ—Ä—Ç—É–≤–∞—Ç–∏</option>
                                    <option value="price_asc" {% if request.GET.sort_by == "price_asc" %}selected{% endif %}>–¶—ñ–Ω–∞: –≤—ñ–¥ –¥–µ—à–µ–≤–∏—Ö –¥–æ –¥–æ—Ä–æ–≥–∏—Ö</option>
                                    <option value="price_desc"  {% if request.GET.sort_by == "price_desc" %}selected{% endif %}>–¶—ñ–Ω–∞: –≤—ñ–¥ –¥–æ—Ä–æ–≥–∏—Ö –¥–æ –¥–µ—à–µ–≤–∏—Ö</option>
                                    <option value="rating" {% if request.GET.sort_by == "rating" %}selected{% endif %} >–†–µ–π—Ç–∏–Ω–≥</option>
                                </select>
        
                                 <!-- –î—ñ–∞–ø–∞–∑–æ–Ω —Ü—ñ–Ω -->
                                <label>–ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ —Ü—ñ–Ω–∞</label>
                                <input type="number" name="price_min" class="w-25 form-control" 
                                    min="0" value="{{ request.GET.price_min|default:'' }}" onchange="this.form.submit()">
                                <label>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ —Ü—ñ–Ω–∞</label>
                                <input type="number" name="price_max" class="w-25 form-control"
                                    min="0" value="{{ request.GET.price_max|default:'' }}" onchange="this.form.submit()">
    
                                <!-- –§—ñ–ª—å—Ç—Ä –∑–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–º -->
                                <label>–†–µ–π—Ç–∏–Ω–≥</label>
                                <select name="rating" class="form-select w-50" onchange="this.form.submit()">
                                    <option value="">–í—Å—ñ</option>
                                    <option value="4" {% if request.GET.rating == "4" %}selected{% endif %}>4+ ‚≠ê</option>
                                    <option value="3" {% if request.GET.rating == "3" %}selected{% endif %}>3+ ‚≠ê</option>
                                    <option value="2" {% if request.GET.rating == "2" %}selected{% endif %}>2+ ‚≠ê</option>
                                </select>
                            </form>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    <main class="container my-3 flex-shrink-0">
        {% block content %} {% endblock %}
    </main>
    <footer class="footer mt-auto py-3 px-2 bg-light">
        <a class="navbar-brand" href="{% url 'about' %}">About Us</a>
    </footer>
</body>
</html>